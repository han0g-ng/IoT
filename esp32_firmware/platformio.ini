; PlatformIO Project Configuration File
; ESP32 Power Monitor & Control System
; Author: IoT Project

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 115200
upload_port = COM4
monitor_port = COM4
upload_flags = 
    --before=default_reset
    --after=hard_reset

; Custom upload command workaround for COM port permission issue
upload_command = C:\Users\ssssss\.platformio\packages\tool-esptoolpy\esptool.py --chip esp32 --port $UPLOAD_PORT --baud $UPLOAD_SPEED --before default_reset --after hard_reset write_flash -z --flash_mode dio --flash_freq 40m --flash_size 4MB 0x1000 $PROJECT_DIR\.pio\build\$PIOENV\bootloader.bin 0x8000 $PROJECT_DIR\.pio\build\$PIOENV\partitions.bin 0x10000 $PROJECT_DIR\.pio\build\$PIOENV\firmware.bin

; Library dependencies
lib_deps = 
    knolleary/PubSubClient@^2.8
    bblanchon/ArduinoJson@^6.21.3
    Wire

; Build flags
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DARDUINO_USB_MODE=1
    -I include

; Monitor filters
monitor_filters = 
    esp32_exception_decoder
    time
